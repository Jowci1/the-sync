<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>THE SYNC</title>

    <meta property="fc:frame" content="vNext" />
    <meta property="fc:frame:image" content="https://the-sync.vercel.app/icon.png" />
    <meta property="fc:frame:button:1" content="ENTER GATE" />

    <style>
        body { margin: 0; background-color: black; color: white; font-family: sans-serif; height: 100vh; overflow: hidden; touch-action: none; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        
        /* Shake Animation for "Crack" Feeling */
        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            20% { transform: translate(-3px, 0px) rotate(-1deg); }
            40% { transform: translate(3px, 2px) rotate(1deg); }
            60% { transform: translate(-3px, 1px) rotate(-1deg); }
            80% { transform: translate(3px, -2px) rotate(1deg); }
            100% { transform: translate(1px, -1px) rotate(0deg); }
        }
        .shake { animation: shake 0.15s; }

        /* GATE SCREEN */
        #gate-screen { position: fixed; inset: 0; background: black; z-index: 2000; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; padding: 20px; }
        #gate-logo { width: 120px; height: 120px; border-radius: 20px; margin-bottom: 30px; box-shadow: 0 0 30px rgba(138, 68, 243, 0.4); }
        .gate-title { font-size: 3.5rem; font-style: italic; font-weight: 900; color: #4a90e2; letter-spacing: -2px; margin-bottom: 10px; }
        .gate-subtitle { font-size: 1.1rem; color: #888; margin-bottom: 40px; }
        .enter-btn { background: white; color: black; padding: 18px 60px; border-radius: 50px; font-weight: bold; font-size: 1.3rem; border: none; cursor: pointer; text-transform: uppercase; }

        /* GAME UI */
        #stats-header { display: none; justify-content: space-around; width: 100%; max-width: 500px; padding: 20px; font-weight: bold; align-items: center; position: absolute; top: 0; z-index: 10; pointer-events: none; }
        .base-label { color: #0052ff; font-size: 1.2rem; } 
        .fc-label { color: #8a44f3; font-size: 1.2rem; }
        .timer { font-size: 3.5rem; color: white; font-weight: 900; }

        /* SVG TARGETS */
        .target { display: none; position: absolute; cursor: pointer; user-select: none; z-index: 5; transition: transform 0.05s ease-out; width: 80px; height: 80px; }

        /* FINAL RESULTS MODAL */
        #score-modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.98); z-index: 3000; flex-direction: column; align-items: center; justify-content: center; }
        .score-box { width: 85%; text-align: center; border: 2px solid #8a44f3; padding: 30px; border-radius: 24px; background: #111; max-width: 350px; }
        .loyalty-text { font-size: 1.1rem; font-weight: bold; margin-bottom: 5px; text-transform: uppercase; }
        .app-quote { font-style: italic; color: #aaa; font-size: 0.9rem; margin-bottom: 15px; line-height: 1.4; min-height: 60px; display: flex; align-items: center; justify-content: center; }
        .final-val { font-size: 3.5rem; font-weight: 900; color: white; margin-bottom: 10px; }
        .share-btn { display: block; width: 100%; padding: 18px; background: linear-gradient(90deg, #0052ff, #8a44f3); color: white; border-radius: 12px; font-weight: bold; margin-top: 10px; text-decoration: none; font-size: 1.1rem; box-sizing: border-box; }
        .retry-btn { background: none; border: none; color: #888; margin-top: 15px; cursor: pointer; text-decoration: underline; }
    </style>
</head>
<body id="game-body">

    <div id="gate-screen">
        <img id="gate-logo" src="https://the-sync.vercel.app/icon.png">
        <div class="gate-title">THE SYNC</div>
        <div class="gate-subtitle">Capture the Signal. Built by Jowci.</div>
        <button class="enter-btn" onclick="startGame()">ENTER GATE</button>
    </div>

    <div id="stats-header">
        <div class="base-label">BASE: <span id="baseVal">0</span></div>
        <div class="timer" id="timerVal">30</div>
        <div class="fc-label">FC: <span id="fcVal">0</span></div>
    </div>

    <div id="btn-base" class="target">
        <svg viewBox="0 0 100 100">
            <rect x="10" y="10" width="80" height="80" rx="12" fill="#0052ff" stroke="white" stroke-width="5"/>
            <text x="50" y="65" text-anchor="middle" font-size="40" font-weight="900" fill="white" font-family="sans-serif">B</text>
        </svg>
    </div>

    <div id="btn-fc" class="target">
        <svg viewBox="0 0 100 100">
            <circle cx="50" cy="50" r="45" fill="#8a44f3" stroke="white" stroke-width="5"/>
            <text x="50" y="65" text-anchor="middle" font-size="40" font-weight="900" fill="white" font-family="sans-serif">F</text>
        </svg>
    </div>

    <div id="score-modal">
        <div class="score-box">
            <div id="loyalty-display" class="loyalty-text">SYNCING...</div>
            <div id="quote-display" class="app-quote">"Thinking..."</div>
            <h2 style="color:#a78bfa; margin: 0; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px;">Total Sync Score</h2>
            <div id="final-score-display" class="final-val">0</div>
            <a id="share-link" href="#" class="share-btn">SHARE SCORE</a>
            <button class="retry-btn" onclick="location.reload()">PLAY AGAIN</button>
        </div>
    </div>

    <script>
        let baseScore = 0, fcScore = 0, timeLeft = 30, gameActive = false;
        const gameBody = document.getElementById('game-body');
        
        const targets = [
            { el: document.getElementById('btn-base'), x: 50, y: 250, dx: 3.8, dy: 3.8, w: 80, h: 80 },
            { el: document.getElementById('btn-fc'), x: 220, y: 400, dx: -3.8, dy: -3.8, w: 80, h: 80 }
        ];

        const baseQuotes = [
            "Base is for everyone. Built to bring the next billion users on-chain.",
            "Based. Not loud. Just building the future of the internet.",
            "Base is a secure, low-cost, builder-friendly Ethereum L2.",
            "All your Base are belong to you. Decentralization is the goal.",
            "The mission: increase economic freedom in the world via Base.",
            "Standardizing the internet on a shared, open-source platform.",
            "Base is incubated by Coinbase and built on the open-source OP Stack.",
            "Based and blue-pilled. The future of finance is here."
        ];

        const fcQuotes = [
            "Farcaster is a sufficiently decentralized social network.",
            "Interesting people, high-signal conversations. That's Farcaster.",
            "Cast, Recast, and Build. The social layer of the crypto world.",
            "Owned by the users, not the corporation. Your identity, your data.",
            "Farcaster Frames: Turning simple posts into interactive mini-apps.",
            "Quality over quantity. High signal is the Farcaster standard.",
            "Built on Ethereum, Farcaster is the town square of the modular future.",
            "Decentralized social is no longer a dream. It's Farcaster."
        ];

        const syncQuotes = [
            "You are the bridge between the protocol and the people.",
            "Perfect balance. You understand the chain is nothing without the community.",
            "The ultimate builder. You are perfectly synced with the future.",
            "On-chain social harmony achieved. You are a true citizen of the New Internet."
        ];

        function startGame() {
            document.getElementById('gate-screen').style.display = 'none';
            document.getElementById('stats-header').style.display = 'flex';
            document.getElementById('btn-base').style.display = 'block';
            document.getElementById('btn-fc').style.display = 'block';
            gameActive = true;
            moveTargets();
            startTimer();
        }

        function moveTargets() {
            if (!gameActive) return;
            targets.forEach(t => {
                t.x += t.dx; t.y += t.dy;
                if (t.x <= 5 || t.x >= window.innerWidth - t.w - 5) t.dx *= -1;
                if (t.y <= 130 || t.y >= window.innerHeight - t.h - 10) t.dy *= -1;
                t.el.style.left = t.x + 'px'; t.el.style.top = t.y + 'px';
            });
            requestAnimationFrame(moveTargets);
        }

        function handleTap(type) {
            if (!gameActive) return;
            if (navigator.vibrate) navigator.vibrate(40);
            
            // Crack Effect
            gameBody.classList.remove('shake');
            void gameBody.offsetWidth; 
            gameBody.classList.add('shake');

            if (type === 'base') { 
                baseScore++; document.getElementById('baseVal').innerText = baseScore; 
            } else { 
                fcScore++; document.getElementById('fcVal').innerText = fcScore; 
            }
        }

        // Event Listeners for Touch and Mouse
        document.getElementById('btn-base').addEventListener('touchstart', (e) => { e.preventDefault(); handleTap('base'); });
        document.getElementById('btn-base').addEventListener('mousedown', (e) => { e.preventDefault(); handleTap('base'); });
        document.getElementById('btn-fc').addEventListener('touchstart', (e) => { e.preventDefault(); handleTap('fc'); });
        document.getElementById('btn-fc').addEventListener('mousedown', (e) => { e.preventDefault(); handleTap('fc'); });

        function startTimer() {
            const timerLoop = setInterval(() => {
                if (timeLeft > 0) {
                    timeLeft--;
                    document.getElementById('timerVal').innerText = timeLeft;
                } else {
                    clearInterval(timerLoop);
                    gameActive = false;
                    endGame();
                }
            }, 1000);
        }

        function endGame() {
            const finalScore = baseScore + fcScore;
            document.getElementById('final-score-display').innerText = finalScore;
            const loyaltyDiv = document.getElementById('loyalty-display');
            const quoteDiv = document.getElementById('quote-display');
            let loyaltyTag = "";

            if (baseScore > fcScore) {
                loyaltyTag = "ðŸ”µ Your loyalty lies with Base";
                loyaltyDiv.style.color = "#0052ff";
                quoteDiv.innerText = baseQuotes[Math.floor(Math.random() * baseQuotes.length)];
            } else if (fcScore > baseScore) {
                loyaltyTag = "ðŸŸ£ Your loyalty lies with Farcaster";
                loyaltyDiv.style.color = "#8a44f3";
                quoteDiv.innerText = fcQuotes[Math.floor(Math.random() * fcQuotes.length)];
            } else {
                loyaltyTag = "âš¡ YOU ARE PERFECTLY SYNCED";
                loyaltyDiv.style.color = "#FFFFFF";
                quoteDiv.innerText = syncQuotes[Math.floor(Math.random() * syncQuotes.length)];
            }

            loyaltyDiv.innerText = loyaltyTag;
            document.getElementById('score-modal').style.display = 'flex';
            
            const shareText = encodeURIComponent(`${loyaltyTag}!\nI achieved a Sync Score of ${finalScore} on THE SYNC! ðŸ”µðŸŸ£\nBuilt by @jowci`);
            document.getElementById('share-link').href = `https://warpcast.com/~/compose?text=${shareText}&embeds[]=${window.location.origin}`;
        }
    </script>
</body>
</html>
