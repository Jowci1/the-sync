<script>
        let baseScore = 0, fcScore = 0, timeLeft = 30, gameActive = false;
        const gameBody = document.getElementById('game-body');
        
        const targets = [
            { el: document.getElementById('btn-base'), x: 50, y: 250, dx: 3.5, dy: 3.5, w: 65, h: 65 },
            { el: document.getElementById('btn-fc'), x: 200, y: 400, dx: -3.5, dy: -3.5, w: 75, h: 75 }
        ];

        // EXPANDED QUOTE LIBRARY
        const baseQuotes = [
            "Base is for everyone. Built to bring the next billion users on-chain.",
            "Based. Not loud. Just building the future of the internet.",
            "Base is a secure, low-cost, builder-friendly Ethereum L2.",
            "All your Base are belong to you. Decentralization is the goal.",
            "Base is incubated by Coinbase and built on the open-source OP Stack.",
            "The mission: increase economic freedom in the world via Base.",
            "Standardizing the internet on a shared, open-source platform.",
            "Base: A bridge to the crypto-economy for builders everywhere."
        ];

        const fcQuotes = [
            "Farcaster is a sufficiently decentralized social network.",
            "Interesting people, high-signal conversations. That's Farcaster.",
            "Farcaster is an open protocolâ€”anyone can build a client to read/write data.",
            "Cast, Recast, and Build. The social layer of the crypto world.",
            "Owned by the users, not the corporation. Your identity, your data.",
            "Built on Ethereum, Farcaster is the town square of the modular future.",
            "Farcaster Frames: Turning simple posts into interactive mini-apps.",
            "Quality over quantity. High signal is the Farcaster standard."
        ];

        function startGame() {
            document.getElementById('gate-screen').style.display = 'none';
            document.getElementById('stats-header').style.display = 'flex';
            document.getElementById('btn-base').style.display = 'flex';
            document.getElementById('btn-fc').style.display = 'flex';
            gameActive = true;
            moveTargets();
            startTimer();
        }

        function moveTargets() {
            if (!gameActive) return;
            targets.forEach(t => {
                t.x += t.dx; t.y += t.dy;
                if (t.x <= 5 || t.x >= window.innerWidth - t.w - 5) t.dx *= -1;
                if (t.y <= 130 || t.y >= window.innerHeight - t.h - 10) t.dy *= -1;
                t.el.style.left = t.x + 'px'; t.el.style.top = t.y + 'px';
            });
            requestAnimationFrame(moveTargets);
        }

        function handleTap(type) {
            if (!gameActive) return;
            if (navigator.vibrate) navigator.vibrate(40);
            gameBody.classList.remove('shake');
            void gameBody.offsetWidth; 
            gameBody.classList.add('shake');

            if (type === 'base') { 
                baseScore++; document.getElementById('baseVal').innerText = baseScore; 
            } else { 
                fcScore++; document.getElementById('fcVal').innerText = fcScore; 
            }
        }

        document.getElementById('btn-base').addEventListener('touchstart', (e) => { e.preventDefault(); handleTap('base'); });
        document.getElementById('btn-fc').addEventListener('touchstart', (e) => { e.preventDefault(); handleTap('fc'); });

        function startTimer() {
            const timerLoop = setInterval(() => {
                if (timeLeft > 0) {
                    timeLeft--;
                    document.getElementById('timerVal').innerText = timeLeft;
                } else {
                    clearInterval(timerLoop);
                    gameActive = false;
                    endGame();
                }
            }, 1000);
        }

        function endGame() {
            const finalScore = baseScore + fcScore;
            document.getElementById('final-score-display').innerText = finalScore;
            
            const loyaltyDiv = document.getElementById('loyalty-display');
            const quoteDiv = document.getElementById('quote-display');
            let loyaltyTag = "";

            if (baseScore > fcScore) {
                loyaltyTag = "ðŸ”µ Your loyalty lies with Base";
                loyaltyDiv.style.color = "#0052ff";
                quoteDiv.innerText = baseQuotes[Math.floor(Math.random() * baseQuotes.length)];
            } else if (fcScore > baseScore) {
                loyaltyTag = "ðŸŸ£ Your loyalty lies with Farcaster";
                loyaltyDiv.style.color = "#8a44f3";
                quoteDiv.innerText = fcQuotes[Math.floor(Math.random() * fcQuotes.length)];
            } else {
                loyaltyTag = "âš¡ You are perfectly synced";
                loyaltyDiv.style.color = "white";
                quoteDiv.innerText = "A perfect balance between the social layer and the chain. You are the ultimate builder.";
            }

            loyaltyDiv.innerText = loyaltyTag;
            document.getElementById('score-modal').style.display = 'flex';
            
            const text = encodeURIComponent(`${loyaltyTag}!\nI achieved a Sync Score of ${finalScore} on THE SYNC! ðŸ”µðŸŸ£\nBuilt by @jowci`);
            document.getElementById('share-link').href = `https://warpcast.com/~/compose?text=${text}&embeds[]=${window.location.origin}`;
        }
    </script>
